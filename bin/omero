#!/usr/bin/env python

"""

:author: Josh Moore <josh@glencoesoftware.com>

Python driver for OMERO
Copyright (c) 2007, Glencoe Software, Inc.
See LICENSE for details.

"""
import sys, os

def readlink(file=sys.argv[0]):
    import stat

    file = sys.argv[0]
    while stat.S_ISLNK(os.lstat(file)[stat.ST_MODE]):
        target = os.readlink(file)
        if target[0] != "/":
            file = os.path.join(os.path.dirname(file), target)
        else:
            file = target

    file = os.path.abspath(file)
    return file

if os.environ.has_key("OMERO_HOME"):
    top = os.environ["OMERO_HOME"]
else:
    exe = readlink()
    top = os.path.join(exe, os.pardir, os.pardir)

top = os.path.normpath(top)
lib = os.path.join(top, "lib")
sys.path.append(lib)

try:
    import omero.cli
    rv = omero.cli.argv()
    sys.exit(rv)
except KeyboardInterrupt, ki:
    print "Cancelled"
    sys.exit(1)
